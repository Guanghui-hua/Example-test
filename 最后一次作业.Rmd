---
title: "17066003+华光辉"
author: "Gray Hua"
date: "2021/5/26"
output:
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1.We want to analyze the stock of International Business Machines Corporation (IBM) based on the its historical prices since April 10, 2017 .
```{r}
setwd("d:/Rdata/13th")
dataSet <- read.csv("HistoricalQuotes.csv")
```


#### 1).  Please write a function which can compute the minimum, maximum, median and sd of a vector. And compute the four values of the close price, open price, low price and high price with your function.

```{r}
desFun <- function(vec,vecName)
{
  
  minimun<- min(vec)
  maximum <- max(vec)
  medianvalue <- median(vec)
  standardDeviation <- sd(vec)
  result <- paste("the minimum of ",vecName,"price is",minimun)
  result1 <- paste("the maximum of ",vecName,"price is", maximum)
  result2 <- paste("the median of   ",vecName,"price is",medianvalue)
  result3 <- paste("the standard deviation of ",vecName,"price is",standardDeviation)
  print(result)
  print(result1)
  print(result2)
  print(result3)
  print("\n",fixed= TRUE)
}


#主程序
desFun(dataSet$close,"close")
desFun(dataSet$open,"open")
desFun(dataSet$high,"high")
desFun(dataSet$low,"low")
```



#### 2).  Please compute the daily return of the stock  based on the closed price.
```{r}
dataSet$return <- dataSet$close-dataSet$open
```

#### 3). Please plot the histogram and density of the daily return. Compare it with a normal curve. 
```{r}
hist(dataSet$return,freq = FALSE,breaks =20,col = "red",xlab = "Return",main = "Histogram of Return")
lines(density(dataSet$return),col = "blue",lwd=2)
x <- dataSet$return
h <- hist(dataSet$return,breaks =20,col = "red",xlab = "Return",main = "Histogram of Return")
xfit <- seq(min(x),max(x),length=40)
yfit <- dnorm(xfit,mean = mean(x),sd = sd(x))
yfit <- yfit*diff(h$mids[1:2])*length(x)
lines(xfit,yfit,col = "green")
box()
```

#### 4).  Please plot the boxplot of the four values close price, open price, low price and high price . Also the  violin plot  of them.
```{r}
boxData <- c(dataSet$close,dataSet$open)
boxplot (dataSet$close,dataSet$open,dataSet$low,dataSet$high,col = c("red","green","orange","blue"))
legend("topleft",pch=c(15,15,15),c("close","open","low","high"),col = c("red","green","orange","blue"),cex=0.7)
library(vioplot)
vioplot (dataSet$close,dataSet$open,dataSet$low,dataSet$high,col = c("red","green","orange","blue"))
legend("topleft",pch=c(15,15,15),c("close","open","low","high"),col = c("red","green","orange","blue"),cex=0.7)
```

#### 5).  Please create a bar plot that represents  means of  the close price, open price, low price and high price.


```{r}
means<- c(mean(dataSet$close),mean(dataSet$open),mean(dataSet$low),mean(dataSet$high))
print(means-150)
barplot(means,ylim=c(152,155),col=c("red","green","orange","blue"))
legend("topleft",pch=c(15,15,15),c("close","open","low","high"),col = c("red","green","orange","blue"),cex=0.7)
```










## 2.p2p数据中对6个网贷平台进行了多次观测，利用该数据完成以下问题：
```{r}
setwd("d:/Rdata/13th")
dataSet <- read.csv("P2P.csv")
#View(dataSet)
```
#### 1）.是不是所有平台的credit变量取值不随时间变化？
```{r}
#dataSet$creValue[dataSet$credit=="Yes"]<-1 
#dataSet$creValue[dataSet$credit=="No"]<- -1

#print(dataSet$时间)
dates <- as.Date(dataSet$时间)
dataSet$dates <-dates
x <- dataSet[order(dataSet$dates),]
x$color[dataSet$credit=="Yes"] <- "red"
x$color[dataSet$credit=="No"] <- "blue"
plot(x$dates,x$id,col = x$color,xlab="dates",ylab = "id")
```

#### 2）若credit变量取值有随时间变化的，找出来是该平台的id.  

根据上图可知，id是1,4,6


